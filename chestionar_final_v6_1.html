<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluare Competente Design Multimedia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Stiluri generale */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e5e7eb;
            padding-top: 1rem;
            padding-bottom: 2rem;
        }
        .page-container {
            background-color: white;
            width: 210mm;
            min-height: 297mm;
            margin: 1rem auto;
            padding: 15mm 18mm 15mm 18mm;
            box-shadow: 0 2px 15px rgba(0,0,0,0.15);
            box-sizing: border-box;
            position: relative;
        }
        #main-content { }
        #header-image-inline {
             display: block; width: 100%; max-width: 100%; height: auto;
             margin-left: auto; margin-right: auto;
             margin-bottom: 10mm;
        }
        /* Footer eliminat */

        /* Stiluri pentru caseta de sumar (ascunsă pe ecran) */
        #print-summary-box {
            /* Ascuns pe ecran prin clasa 'hidden' */
            border: 1px solid #ccc;
            padding: 10px;
            margin-bottom: 15px;
            background: #f9f9f9;
            font-size: 10pt;
        }
         #print-summary-box h2 { margin-bottom: 8px; font-size: 11pt; font-weight: bold; }
         #print-summary-box p { margin-bottom: 4px; }


        /* Stiluri specifice pentru printare */
        @media print {
            body { background-color: white; padding: 0; margin: 0; font-size: 9pt; }
            .page-container { width: 100%; min-height: 0; height: auto; margin: 0; box-shadow: none; padding: 0; border: none; }
            #main-content { padding: 15mm 15mm 15mm 15mm; } /* Margini egale la print */
            /* Ascundem elementele non-print */
            #participant-section, #action-buttons, #dataLoadingStatus, h1#page-title { display: none !important; }
            /* Afișăm antetul și caseta de sumar la print */
            #header-image-inline { display: block !important; margin-bottom: 8mm !important; }
            #print-summary-box { display: block !important; page-break-after: avoid !important; } /* Afișăm caseta la print */
            /* Footer eliminat */
            .question-section { page-break-inside: avoid !important; box-shadow: none; border: none; margin-bottom: 0.5rem; padding: 0.5rem 0; }
            h2.section-title { margin-bottom: 0.5rem; padding-bottom: 0.2rem; font-size: 10pt; border-bottom: 1px solid #ccc; }
            .criteria-title { font-size: 9pt; margin-bottom: 0.4rem; }
            .question { margin-left: 0; margin-bottom: 0.6rem; padding-bottom: 0.6rem; border-bottom: none; } /* Fără linie */
            label { font-size: 8pt; line-height: 1.2; }
            input[type="radio"] { width: 0.8rem; height: 0.8rem; top: 0.1rem; border-width: 1px; }
            input[type="radio"]:checked::after { width: 0.35rem; height: 0.35rem; }
            #results { margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #ccc; page-break-before: auto; }
            #results h2 { font-size: 11pt; margin-bottom: 0.4rem; }
            #sectionScoresDisplay p { font-size: 8.5pt; padding: 0.15rem 0; border: none; background: none; }
            #results > div.text-center { font-size: 10pt; padding: 0.4rem; margin-bottom: 0.4rem; }
            #feedbackMessage { font-size: 9pt; padding: 0.5rem; border: none; background: none !important; color: black !important; }
            a { text-decoration: none; color: inherit; }
        }

        /* Restul stilurilor */
        input[type="radio"]:hover { border-color: #9ca3af; }
        input[type="radio"]:checked { border-color: #4f46e5; background-color: #4f46e5; }
        input[type="radio"]:checked::after { content: ''; display: block; width: 0.5rem; height: 0.5rem; background-color: white; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        select { padding: 0.4rem 2.5rem 0.4rem 0.75rem; border: 1px solid #d1d5db; border-radius: 0.375rem; background-color: white; width: 100%; box-sizing: border-box; font-size: 0.875rem; appearance: none; -webkit-appearance: none; -moz-appearance: none; background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e"); background-repeat: no-repeat; background-position: right 0.5rem center; background-size: 1.5em 1.5em; transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out; }
        select:disabled { background-color: #f3f4f6; cursor: not-allowed; opacity: 0.7; }
        select:focus { outline: 2px solid transparent; outline-offset: 2px; border-color: #4f46e5; box-shadow: 0 0 0 2px rgba(79, 70, 229, 0.5); }
        .data-display { margin-top: 0.25rem; display: block; width: 100%; padding: 0.5rem 0.75rem; background-color: #e5e7eb; border: 1px solid #d1d5db; border-radius: 0.375rem; min-height: 36px; color: #4b5563; font-size: 0.875rem; line-height: 1.25rem; box-sizing: border-box; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        #feedbackMessage { border-left-width: 4px; padding: 1rem; margin-top: 1.5rem; border-radius: 0.375rem; font-size: 0.95rem; text-align: left; }
        .feedback-insufficient { border-color: #ef4444; background-color: #fee2e2; color: #b91c1c; }
        .feedback-developing { border-color: #f97316; background-color: #ffedd5; color: #c2410c; }
        .feedback-competent { border-color: #22c55e; background-color: #dcfce7; color: #15803d; }
        .feedback-exemplary { border-color: #4f46e5; background-color: #e0e7ff; color: #3730a3; }
        #sectionScoresDisplay p { padding: 0.5rem 1rem; border-radius: 0.25rem; background-color: #f9fafb; border: 1px solid #e5e7eb; font-size: 0.9rem; }
        .question-section { background-color: #ffffff; border-radius: 0.5rem; margin-bottom: 1rem; border: 1px solid #e5e7eb; padding: 1rem; }
        .participant-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 0.75rem; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid #4f46e5; border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; margin-left: 10px; vertical-align: middle; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        #dataLoadingStatus { color: #1d4ed8; background-color: #dbeafe; border: 1px solid #93c5fd; padding: 0.75rem; border-radius: 0.375rem; margin-bottom: 1rem; font-size: 0.875rem; text-align: center; }
        #dataLoadingStatus.error { color: #b91c1c; background-color: #fee2e2; border-color: #fca5a5; }
        .section-title { font-size: 1.1rem; font-weight: 600; color: #1e3a8a; margin-bottom: 0.8rem; border-bottom: 1px solid #d1d5db; padding-bottom: 0.4rem; }
        .criteria-title { font-size: 0.9rem; font-weight: 600; color: #1f2937; margin-bottom: 0.5rem; padding-top: 0.3rem; }
        .question { margin-left: 0.3rem; margin-bottom: 0.8rem; padding-bottom: 0.8rem; border-bottom: none; } /* Eliminat border-bottom */
        .indicator-text { font-weight: 500; color: #4b5563; margin-bottom: 0.3rem; display: flex; align-items: flex-start; font-size: 0.8rem; }
        .indicator-prefix { font-weight: 600; margin-right: 0.4rem; color: #1e3a8a; min-width: 3em; }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <div id="page-content" class="page-container">
        <img id="header-image-inline" src="header_color.jpg" alt="Antet">

        <div id="main-content">
            <h1 id="page-title" class="text-xl md:text-2xl font-bold text-gray-800 mb-8 text-center">Evaluare a Competențelor de Design și Multimedia în contextul portofoliilor premergătoare Resurselor Educaționale Deschise</h1>

            <div id="dataLoadingStatus">Se încarcă datele participanților... Vă rugăm așteptați.</div>

            <div id="participant-section" class="mb-6 border border-gray-300 rounded-lg shadow-sm overflow-hidden p-5 bg-gray-100">
                 <h2 id="participant-section-header" class="text-lg font-semibold text-gray-700 mb-4">Informații personale cursant</h2>
                 <div class="participant-grid">
                    <div class="space-y-1">
                        <label for="monthSelect" class="block text-sm font-medium text-gray-700">Luna Evaluării:</label>
                        <select id="monthSelect" name="month" class="mt-1 block w-full shadow-sm" disabled>
                            <option value="">Așteptați...</option>
                        </select>
                    </div>
                    <div class="space-y-1">
                        <label for="expertSelect" class="block text-sm font-medium text-gray-700">Expert Multimedia:</label>
                        <select id="expertSelect" name="expert" class="mt-1 block w-full shadow-sm" disabled>
                            <option value="">Selectați Expertul...</option>
                        </select>
                    </div>
                    <div class="space-y-1">
                        <label for="groupSelect" class="block text-sm font-medium text-gray-700">Grupă:</label>
                        <select id="groupSelect" name="group" class="mt-1 block w-full shadow-sm" disabled>
                            <option value="">Selectați Grupa...</option>
                        </select>
                    </div>
                    <div class="space-y-1">
                        <label for="participantSelect" class="block text-sm font-medium text-gray-700">Cursant:</label>
                        <select id="participantSelect" name="participant" class="mt-1 block w-full shadow-sm" disabled>
                            <option value="">Selectați Cursantul...</option>
                        </select>
                    </div>
                    <div class="space-y-1">
                         <label class="block text-sm font-medium text-gray-700">Email Cursant:</label>
                         <span id="participantEmailDisplay" class="data-display">...</span>
                    </div>
                 </div>
            </div>

            <div id="print-summary-box" class="hidden border border-gray-400 rounded-lg p-4 mb-6 bg-gray-50">
                <h2 class="text-lg font-semibold mb-2">Informații Evaluare</h2>
                <p id="printParticipantName" class="text-sm"></p>
                <p id="printGroup" class="text-sm"></p>
                <p id="printEvalDate" class="text-sm"></p>
                <p id="printTotalScore" class="text-sm font-medium"></p>
                <hr class="mt-4 mb-2 border-gray-300">
            </div>


            <form id="evaluationForm">
                <div class="space-y-6">
                    <div class="question-section border border-gray-300 p-5 rounded-lg shadow-md" data-section-id="1" data-section-name="Concept Vizual și Coerență Stilistică">
                        <h2 class="section-title">1. Concept Vizual și Coerență Stilistică</h2>
                        <div class="space-y-5"> <fieldset class="question-group">
                                 <legend class="criteria-title">1.1. Claritatea și Adecvarea Conceptului Vizual Propus</legend>
                                 <div class="question" data-question-id="1.1">
                                     <p class="indicator-text"><span class="indicator-prefix">1.1.1.</span> Stilul vizual general propus (minimalist, ludic, formal etc.) este clar definit și aparent.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q1.1" value="3" data-points="3"> Exemplar (Stil clar, evident, justificat)</label>
                                         <label><input type="radio" name="q1.1" value="2" data-points="2"> Competent (Stil în general clar, poate nejustificat)</label>
                                         <label><input type="radio" name="q1.1" value="1" data-points="1"> În Dezvoltare (Stil neclar, amestecat)</label>
                                         <label><input type="radio" name="q1.1" value="0" data-points="0"> Insuficient (Niciun stil vizual identificabil)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="1.2">
                                     <p class="indicator-text"><span class="indicator-prefix">1.1.2.</span> Stilul vizual propus este adecvat disciplinei, conținutului educațional și publicului țintă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q1.2" value="3" data-points="3"> Exemplar (Stil foarte potrivit pentru context)</label>
                                         <label><input type="radio" name="q1.2" value="2" data-points="2"> Competent (Stil în general potrivit, mici nepotriviri)</label>
                                         <label><input type="radio" name="q1.2" value="1" data-points="1"> În Dezvoltare (Stil parțial nepotrivit)</label>
                                         <label><input type="radio" name="q1.2" value="0" data-points="0"> Insuficient (Inadecvare clară între stil și context)</label>
                                     </div>
                                 </div>
                                  <div class="question" data-question-id="1.3">
                                     <p class="indicator-text"><span class="indicator-prefix">1.1.3.</span> Justificarea alegerilor stilistice majore (în reflecții/plan) este prezentă și pertinentă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q1.3" value="3" data-points="3"> Exemplar (Justificare excelentă, detaliată și pertinentă)</label>
                                         <label><input type="radio" name="q1.3" value="2" data-points="2"> Competent (Justificare prezentă, dar sumară/parțial pertinentă)</label>
                                         <label><input type="radio" name="q1.3" value="1" data-points="1"> În Dezvoltare (Justificare vagă sau irelevantă)</label>
                                         <label><input type="radio" name="q1.3" value="0" data-points="0"> Insuficient (Nicio justificare a alegerilor stilistice)</label>
                                     </div>
                                 </div>
                            </fieldset>

                            <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">1.2. Coerența Vizuală Planificată</legend>
                                 <div class="question" data-question-id="1.4">
                                     <p class="indicator-text"><span class="indicator-prefix">1.2.1.</span> Planificarea utilizării consistente a elementelor (culori, fonturi, grafică) între mockup-uri.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q1.4" value="3" data-points="3"> Exemplar (Plan detaliat și specific pentru coerență)</label>
                                         <label><input type="radio" name="q1.4" value="2" data-points="2"> Competent (Plan general pentru coerență, detalii lipsă)</label>
                                         <label><input type="radio" name="q1.4" value="1" data-points="1"> În Dezvoltare (Plan vag sau menționare superficială a coerenței)</label>
                                         <label><input type="radio" name="q1.4" value="0" data-points="0"> Insuficient (Lipsa planificării coerenței)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="1.5">
                                     <p class="indicator-text"><span class="indicator-prefix">1.2.2.</span> Mockup-urile/artefactele prezintă un aspect unitar, nu un amestec de stiluri.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q1.5" value="3" data-points="3"> Exemplar (Toate mockup-urile respectă același stil vizual definit)</label>
                                         <label><input type="radio" name="q1.5" value="2" data-points="2"> Competent (Majoritatea mockup-urilor coerente, excepții minore)</label>
                                         <label><input type="radio" name="q1.5" value="1" data-points="1"> În Dezvoltare (Mockup-uri cu stiluri diferite, confuzie)</label>
                                         <label><input type="radio" name="q1.5" value="0" data-points="0"> Insuficient (Haos vizual, lipsă de unitate)</label>
                                     </div>
                                 </div>
                             </fieldset>
                        </div>
                        <div class="mt-6 text-right font-semibold text-gray-700">
                            Scor Secțiunea 1: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">15</span>
                        </div>
                    </div>
                    <div class="question-section border border-gray-300 p-6 rounded-lg shadow-md" data-section-id="2" data-section-name="Layout și Structură Vizuală">
                        <h2 class="section-title">2. Layout și Structură Vizuală (Planificate)</h2>
                        <div class="space-y-6"> <fieldset class="question-group">
                                 <legend class="criteria-title">2.1. Aplicarea Principiilor de Compoziție Vizuală</legend>
                                 <div class="question" data-question-id="2.1">
                                     <p class="indicator-text"><span class="indicator-prefix">2.1.1.</span> Intenția de a utiliza <strong>echilibrul</strong> vizual în mockup-uri.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.1" value="3" data-points="3"> Exemplar (Echilibru evident și bine realizat)</label>
                                         <label><input type="radio" name="q2.1" value="2" data-points="2"> Competent (Echilibru prezent, dar perfectibil)</label>
                                         <label><input type="radio" name="q2.1" value="1" data-points="1"> În Dezvoltare (Elemente par aruncate aleatoriu)</label>
                                         <label><input type="radio" name="q2.1" value="0" data-points="0"> Insuficient (Lipsă totală de echilibru)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="2.2">
                                     <p class="indicator-text"><span class="indicator-prefix">2.1.2.</span> Intenția de a utiliza <strong>alinierea</strong> pentru ordine și structură.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.2" value="3" data-points="3"> Exemplar (Aliniere riguroasă, creează ordine clară)</label>
                                         <label><input type="radio" name="q2.2" value="2" data-points="2"> Competent (Majoritatea elementelor aliniate, mici inconsistențe)</label>
                                         <label><input type="radio" name="q2.2" value="1" data-points="1"> În Dezvoltare (Aliniere inconsistentă, aspect dezordonat)</label>
                                         <label><input type="radio" name="q2.2" value="0" data-points="0"> Insuficient (Aliniere haotică, nicio linie directoare)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="2.3">
                                     <p class="indicator-text"><span class="indicator-prefix">2.1.3.</span> Intenția de a utiliza <strong>proximitatea</strong> pentru gruparea logică.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.3" value="3" data-points="3"> Exemplar (Grupare logică și clară a elementelor relaționate)</label>
                                         <label><input type="radio" name="q2.3" value="2" data-points="2"> Competent (Grupare în general logică, unele ambiguități)</label>
                                         <label><input type="radio" name="q2.3" value="1" data-points="1"> În Dezvoltare (Grupare confuză sau ilogică)</label>
                                         <label><input type="radio" name="q2.3" value="0" data-points="0"> Insuficient (Nicio aplicare a principiului proximității)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="2.4">
                                     <p class="indicator-text"><span class="indicator-prefix">2.1.4.</span> Intenția de a utiliza <strong>contrastul</strong> pentru evidențiere.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.4" value="3" data-points="3"> Exemplar (Contrast folosit eficient pentru ierarhie și focus)</label>
                                         <label><input type="radio" name="q2.4" value="2" data-points="2"> Competent (Contrast prezent, dar ar putea fi mai accentuat/strategic)</label>
                                         <label><input type="radio" name="q2.4" value="1" data-points="1"> În Dezvoltare (Contrast slab sau utilizat ineficient)</label>
                                         <label><input type="radio" name="q2.4" value="0" data-points="0"> Insuficient (Niciun element nu iese în evidență, uniformitate)</label>
                                     </div>
                                 </div>
                                 </fieldset>

                             <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">2.2. Utilizarea Spațiului Alb (Negativ)</legend>
                                 <div class="question" data-question-id="2.6">
                                     <p class="indicator-text"><span class="indicator-prefix">2.2.1.</span> Mockup-urile/planurile includ suficient spațiu alb pentru lizibilitate.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.6" value="3" data-points="3"> Exemplar (Layout aerisit, spațiu alb generos)</label>
                                         <label><input type="radio" name="q2.6" value="2" data-points="2"> Competent (Spațiu alb suficient în majoritatea zonelor)</label>
                                         <label><input type="radio" name="q2.6" value="1" data-points="1"> În Dezvoltare (Layout aglomerat, spațiu insuficient)</label>
                                         <label><input type="radio" name="q2.6" value="0" data-points="0"> Insuficient (Lipsă totală de spațiu alb, design sufocant)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="2.7">
                                     <p class="indicator-text"><span class="indicator-prefix">2.2.2.</span> Spațiul alb este utilizat strategic pentru a separa și evidenția.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.7" value="3" data-points="3"> Exemplar (Utilizare inteligentă a spațiului alb pentru structură și focus)</label>
                                         <label><input type="radio" name="q2.7" value="2" data-points="2"> Competent (Utilizare funcțională a spațiului alb, dar mai puțin strategică)</label>
                                         <label><input type="radio" name="q2.7" value="1" data-points="1"> În Dezvoltare (Utilizarea spațiului alb pare întâmplătoare)</label>
                                         <label><input type="radio" name="q2.7" value="0" data-points="0"> Insuficient (Nicio utilizare strategică a spațiului alb)</label>
                                     </div>
                                 </div>
                             </fieldset>

                              <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">2.3. Ierarhia Vizuală</legend>
                                 <div class="question" data-question-id="2.8">
                                     <p class="indicator-text"><span class="indicator-prefix">2.3.1.</span> Planificarea diferențierii clare (mărime, culoare, stil) titluri/text.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.8" value="3" data-points="3"> Exemplar (Ierarhie textuală foarte clară și consistentă)</label>
                                         <label><input type="radio" name="q2.8" value="2" data-points="2"> Competent (Ierarhie textuală în general clară, mici neclarități)</label>
                                         <label><input type="radio" name="q2.8" value="1" data-points="1"> În Dezvoltare (Diferențiere slabă sau inconsistentă între niveluri)</label>
                                         <label><input type="radio" name="q2.8" value="0" data-points="0"> Insuficient (Nicio ierarhie vizuală în text)</label>
                                     </div>
                                 </div>
                                  <div class="question" data-question-id="2.9">
                                     <p class="indicator-text"><span class="indicator-prefix">2.3.2.</span> Evidențierea vizuală (planificată) a elementelor cheie (butoane etc.).</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q2.9" value="3" data-points="3"> Exemplar (Elemente cheie foarte proeminente și ușor de identificat)</label>
                                         <label><input type="radio" name="q2.9" value="2" data-points="2"> Competent (Elemente cheie vizibile, dar ar putea fi mai proeminente)</label>
                                         <label><input type="radio" name="q2.9" value="1" data-points="1"> În Dezvoltare (Elemente cheie slab evidențiate)</label>
                                         <label><input type="radio" name="q2.9" value="0" data-points="0"> Insuficient (Elementele cheie nu sunt evidențiate)</label>
                                     </div>
                                 </div>
                             </fieldset>
                        </div>
                         <div class="mt-6 text-right font-semibold text-gray-700">
                            Scor Secțiunea 2: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">24</span> </div>
                    </div>
                     <div class="question-section border border-gray-300 p-6 rounded-lg shadow-md" data-section-id="3" data-section-name="Culoare și Tipografie">
                        <h2 class="section-title">3. Culoare și Tipografie (Proiectate)</h2>
                        <div class="space-y-6">
                             <fieldset class="question-group">
                                 <legend class="criteria-title">3.1. Paleta Cromatică</legend>
                                 <div class="question" data-question-id="3.1">
                                     <p class="indicator-text"><span class="indicator-prefix">3.1.1.</span> Paleta de culori propusă este armonioasă și limitată (max 3-4 culori princ.).</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.1" value="3" data-points="3"> Exemplar (Paletă coerentă, armonioasă, limitată și bine aleasă)</label>
                                         <label><input type="radio" name="q3.1" value="2" data-points="2"> Competent (Paletă în general armonioasă, poate ușor extinsă)</label>
                                         <label><input type="radio" name="q3.1" value="1" data-points="1"> În Dezvoltare (Prea multe culori sau culori nearmonioase)</label>
                                         <label><input type="radio" name="q3.1" value="0" data-points="0"> Insuficient (Nicio paletă definită sau culori alese haotic)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="3.2">
                                     <p class="indicator-text"><span class="indicator-prefix">3.1.2.</span> Culorile alese sunt adecvate temei educaționale și publicului țintă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.2" value="3" data-points="3"> Exemplar (Culori foarte potrivite contextului educațional)</label>
                                         <label><input type="radio" name="q3.2" value="2" data-points="2"> Competent (Culori în general adecvate, mici nepotriviri)</label>
                                         <label><input type="radio" name="q3.2" value="1" data-points="1"> În Dezvoltare (Culori parțial nepotrivite)</label>
                                         <label><input type="radio" name="q3.2" value="0" data-points="0"> Insuficient (Culori total inadecvate contextului)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="3.3">
                                     <p class="indicator-text"><span class="indicator-prefix">3.1.3.</span> Contrastul de culoare planificat text-fundal este suficient (&gt;4.5:1).</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.3" value="3" data-points="3"> Exemplar (Contrast excelent în toate combinațiile propuse)</label>
                                         <label><input type="radio" name="q3.3" value="2" data-points="2"> Competent (Contrast bun în majoritatea cazurilor, excepții minore)</label>
                                         <label><input type="radio" name="q3.3" value="1" data-points="1"> În Dezvoltare (Contrast slab în unele exemple notabile)</label>
                                         <label><input type="radio" name="q3.3" value="0" data-points="0"> Insuficient (Contrast insuficient în multiple exemple, text greu de citit)</label>
                                     </div>
                                 </div>
                            </fieldset>

                             <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">3.2. Selecția și Utilizarea Fonturilor</legend>
                                 <div class="question" data-question-id="3.4">
                                     <p class="indicator-text"><span class="indicator-prefix">3.2.1.</span> Fonturile selectate (max 2-3 familii) sunt lizibile pe ecran.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.4" value="3" data-points="3"> Exemplar (Fonturi foarte lizibile, bine alese pentru digital)</label>
                                         <label><input type="radio" name="q3.4" value="2" data-points="2"> Competent (Fonturi lizibile, dar poate nu optime)</label>
                                         <label><input type="radio" name="q3.4" value="1" data-points="1"> În Dezvoltare (Unul dintre fonturi este greu lizibil)</label>
                                         <label><input type="radio" name="q3.4" value="0" data-points="0"> Insuficient (Fonturi total nepotrivite/ilizibile)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="3.5">
                                     <p class="indicator-text"><span class="indicator-prefix">3.2.2.</span> Fonturile sunt utilizate consistent și ierarhic.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.5" value="3" data-points="3"> Exemplar (Utilizare foarte consistentă și ierarhică a fonturilor)</label>
                                         <label><input type="radio" name="q3.5" value="2" data-points="2"> Competent (Utilizare în general consistentă, mici excepții)</label>
                                         <label><input type="radio" name="q3.5" value="1" data-points="1"> În Dezvoltare (Utilizare inconsistentă sau ierarhie confuză)</label>
                                         <label><input type="radio" name="q3.5" value="0" data-points="0"> Insuficient (Utilizare haotică a fonturilor)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="3.6">
                                     <p class="indicator-text"><span class="indicator-prefix">3.2.3.</span> Se evită fonturile excesiv de decorative în corpul textului.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q3.6" value="3" data-points="3"> Exemplar (Fonturi decorative folosite minim și adecvat, text lizibil)</label>
                                         <label><input type="radio" name="q3.6" value="2" data-points="2"> Competent (Fonturi decorative folosite limitat, lizibilitate OK)</label>
                                         <label><input type="radio" name="q3.6" value="1" data-points="1"> În Dezvoltare (Fonturi decorative folosite în exces, afectează lizibilitatea)</label>
                                         <label><input type="radio" name="q3.6" value="0" data-points="0"> Insuficient (Corpul textului scris cu font decorativ, ilizibil)</label>
                                     </div>
                                 </div>
                             </fieldset>
                        </div>
                         <div class="mt-6 text-right font-semibold text-gray-700">
                            Scor Secțiunea 3: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">18</span>
                        </div>
                    </div>
                     <div class="question-section border border-gray-300 p-6 rounded-lg shadow-md" data-section-id="4" data-section-name="Planificare Selecție și Integrare Multimedia">
                        <h2 class="section-title">4. Planificare Selecție și Integrare Multimedia</h2>
                        <div class="space-y-6">
                             <fieldset class="question-group">
                                 <legend class="criteria-title">4.1. Relevanța Pedagogică a Media Planificate</legend>
                                 <div class="question" data-question-id="4.1">
                                     <p class="indicator-text"><span class="indicator-prefix">4.1.1.</span> Justificarea alegerii elementelor multimedia leagă media de obiectivele învățării.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.1" value="3" data-points="3"> Exemplar (Justificare clară și directă a legăturii cu obiectivele)</label>
                                         <label><input type="radio" name="q4.1" value="2" data-points="2"> Competent (Justificare prezentă, dar legătura e mai puțin directă)</label>
                                         <label><input type="radio" name="q4.1" value="1" data-points="1"> În Dezvoltare (Justificare vagă sau legătură slabă cu obiectivele)</label>
                                         <label><input type="radio" name="q4.1" value="0" data-points="0"> Insuficient (Nicio justificare sau media pare irelevantă pedagogic)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="4.2">
                                     <p class="indicator-text"><span class="indicator-prefix">4.1.2.</span> Media propusă sprijină/clarifică conținutul, nu este pur decorativă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.2" value="3" data-points="3"> Exemplar (Media ilustrează/clarifică perfect conceptele)</label>
                                         <label><input type="radio" name="q4.2" value="2" data-points="2"> Competent (Media sprijină conținutul, dar rolul putea fi mai clar)</label>
                                         <label><input type="radio" name="q4.2" value="1" data-points="1"> În Dezvoltare (Unele elemente media par decorative/de umplutură)</label>
                                         <label><input type="radio" name="q4.2" value="0" data-points="0"> Insuficient (Media este exclusiv decorativă sau distrage atenția)</label>
                                     </div>
                                 </div>
                            </fieldset>

                             <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">4.2. Calitatea Tehnică și Optimizarea Media (Planificate)</legend>
                                 <div class="question" data-question-id="4.3">
                                     <p class="indicator-text"><span class="indicator-prefix">4.2.1.</span> Există dovezi ale preocupării pentru calitatea tehnică a media.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.3" value="3" data-points="3"> Exemplar (Preocupare explicită și specifică pentru calitate)</label>
                                         <label><input type="radio" name="q4.3" value="2" data-points="2"> Competent (Menționare generală a nevoii de calitate)</label>
                                         <label><input type="radio" name="q4.3" value="1" data-points="1"> În Dezvoltare (Nicio mențiune despre calitatea tehnică)</label>
                                         <label><input type="radio" name="q4.3" value="0" data-points="0"> Insuficient (Se propun explicit media de calitate slabă)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="4.4">
                                     <p class="indicator-text"><span class="indicator-prefix">4.2.2.</span> Este menționată intenția de a optimiza media pentru web/mobil.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.4" value="3" data-points="3"> Exemplar (Intenție clară și specifică de optimizare)</label>
                                         <label><input type="radio" name="q4.4" value="2" data-points="2"> Competent (Menționare generală a nevoii de optimizare)</label>
                                         <label><input type="radio" name="q4.4" value="1" data-points="1"> În Dezvoltare (Nu se abordează problema optimizării)</label>
                                         <label><input type="radio" name="q4.4" value="0" data-points="0"> Insuficient (Planul sugerează utilizarea de fișiere neoptimizate)</label>
                                     </div>
                                 </div>
                             </fieldset>

                              <fieldset class="question-group pt-4 border-t border-gray-200">
                                 <legend class="criteria-title">4.3. Integrarea Vizuală a Media (Planificată)</legend>
                                 <div class="question" data-question-id="4.5">
                                     <p class="indicator-text"><span class="indicator-prefix">4.3.1.</span> Plasarea planificată a media în layout este logică și estetică.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.5" value="3" data-points="3"> Exemplar (Integrare elegantă, logică și estetică)</label>
                                         <label><input type="radio" name="q4.5" value="2" data-points="2"> Competent (Integrare logică, dar aspectul estetic poate fi îmbunătățit)</label>
                                         <label><input type="radio" name="q4.5" value="1" data-points="1"> În Dezvoltare (Media pare plasată la întâmplare, întrerupe fluxul)</label>
                                         <label><input type="radio" name="q4.5" value="0" data-points="0"> Insuficient (Niciun plan clar de integrare vizuală)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="4.6">
                                     <p class="indicator-text"><span class="indicator-prefix">4.3.2.</span> Media completează conținutul, fără a crea aglomerare vizuală.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q4.6" value="3" data-points="3"> Exemplar (Media bine dimensionată, completează fără a aglomera)</label>
                                         <label><input type="radio" name="q4.6" value="2" data-points="2"> Competent (Media în general bine integrată, poate ușor aglomerat)</label>
                                         <label><input type="radio" name="q4.6" value="1" data-points="1"> În Dezvoltare (Pagină supraîncărcată cu media)</label>
                                         <label><input type="radio" name="q4.6" value="0" data-points="0"> Insuficient (Integrarea media creează dezordine vizuală)</label>
                                     </div>
                                 </div>
                             </fieldset>
                        </div>
                         <div class="mt-6 text-right font-semibold text-gray-700">
                            Scor Secțiunea 4: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">18</span>
                        </div>
                    </div>
                     <div class="question-section border border-gray-300 p-6 rounded-lg shadow-md" data-section-id="5" data-section-name="Design Interfață, Interactivitate & Accesibilitate">
                        <h2 class="section-title">5. Design Interfață, Interactivitate & Accesibilitate</h2>
                        <div class="space-y-6">
                             <fieldset class="question-group">
                                 <legend class="criteria-title">5.1. Claritatea și Intuitivitatea Interfeței (Conceptuale)</legend>
                                 <div class="question" data-question-id="5.1">
                                     <p class="indicator-text"><span class="indicator-prefix">5.1.1.</span> Elementele de control (butoane, meniuri) propuse în mockup sunt vizibile, ușor de identificat.</p>
                                     <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q5.1" value="3" data-points="3"> Exemplar (Elemente de control foarte clare și distincte)</label>
                                         <label><input type="radio" name="q5.1" value="2" data-points="2"> Competent (Elemente de control clare în majoritate)</label>
                                         <label><input type="radio" name="q5.1" value="1" data-points="1"> În Dezvoltare (Unele elemente greu de distins/identificat)</label>
                                         <label><input type="radio" name="q5.1" value="0" data-points="0"> Insuficient (Elemente de control inexistente sau complet neclare)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="5.2">
                                     <p class="indicator-text"><span class="indicator-prefix">5.1.2.</span> Funcția elementelor interactive pare intuitivă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q5.2" value="3" data-points="3"> Exemplar (Funcție evidentă și intuitivă pentru toate elementele)</label>
                                         <label><input type="radio" name="q5.2" value="2" data-points="2"> Competent (Funcție în general intuitivă, mici ambiguități)</label>
                                         <label><input type="radio" name="q5.2" value="1" data-points="1"> În Dezvoltare (Funcția unor elemente este neclară/ambiguă)</label>
                                         <label><input type="radio" name="q5.2" value="0" data-points="0"> Insuficient (Designul elementelor este contraintuitiv)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="5.3">
                                     <p class="indicator-text"><span class="indicator-prefix">5.1.3.</span> Structura de navigare propusă (în schiță/mockup) este logică și previzibilă.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q5.3" value="3" data-points="3"> Exemplar (Navigare foarte logică, clară și previzibilă)</label>
                                         <label><input type="radio" name="q5.3" value="2" data-points="2"> Competent (Navigare în general logică, mici neclarități posibile)</label>
                                         <label><input type="radio" name="q5.3" value="1" data-points="1"> În Dezvoltare (Structura de navigare este parțial confuză)</label>
                                         <label><input type="radio" name="q5.3" value="0" data-points="0"> Insuficient (Structura de navigare propusă este haotică)</label>
                                     </div>
                                 </div>
                                 <div class="question" data-question-id="5.4">
                                     <p class="indicator-text"><span class="indicator-prefix">5.1.4.</span> Consistența elementelor UI este menținută (planificată) între ecrane/pagini.</p>
                                      <div class="space-y-1 pl-4">
                                         <label><input type="radio" name="q5.4" value="3" data-points="3"> Exemplar (Consistență excelentă a UI pe toate paginile)</label>
                                         <label><input type="radio" name="q5.4" value="2" data-points="2"> Competent (Consistență bună, excepții minore și justificate)</label>
                                         <label><input type="radio" name="q5.4" value="1" data-points="1"> În Dezvoltare (Inconsistențe notabile în UI între pagini)</label>
                                         <label><input type="radio" name="q5.4" value="0" data-points="0"> Insuficient (Inconsistență majoră a elementelor UI)</label>
                                     </div>
                                 </div>
                            </fieldset>
                            <fieldset class="question-group pt-4 border-t border-gray-200">
                                <legend class="criteria-title">5.2. Planificarea Feedback-ului Vizual</legend>
                                <div class="question" data-question-id="5.5">
                                    <p class="indicator-text"><span class="indicator-prefix">5.2.1.</span> Portofoliul indică intenția de a oferi feedback vizual la interacțiuni.</p>
                                    <div class="space-y-1 pl-4">
                                        <label><input type="radio" name="q5.5" value="3" data-points="3"> Exemplar (Intenție clară și specifică de feedback vizual)</label>
                                        <label><input type="radio" name="q5.5" value="2" data-points="2"> Competent (Intenție menționată general)</label>
                                        <label><input type="radio" name="q5.5" value="1" data-points="1"> În Dezvoltare (Nicio mențiune despre feedback vizual)</label>
                                        <label><input type="radio" name="q5.5" value="0" data-points="0"> Insuficient (Designul exclude posibilitatea feedback-ului)</label>
                                    </div>
                                </div>
                            </fieldset>
                            <fieldset class="question-group pt-4 border-t border-gray-200">
                                <legend class="criteria-title">5.3. Conștientizarea Accesibilității Vizuale</legend>
                                <div class="question" data-question-id="5.6">
                                    <p class="indicator-text"><span class="indicator-prefix">5.3.1.</span> Preocuparea pentru contrastul culorilor este evidentă în design.</p>
                                    <div class="space-y-1 pl-4">
                                        <label><input type="radio" name="q5.6" value="3" data-points="3"> Exemplar (Contrast excelent, verificabil, preocupare evidentă)</label>
                                        <label><input type="radio" name="q5.6" value="2" data-points="2"> Competent (Contrast bun în general, mici probleme potențiale)</label>
                                        <label><input type="radio" name="q5.6" value="1" data-points="1"> În Dezvoltare (Contrast slab în unele zone, nemenționat)</label>
                                        <label><input type="radio" name="q5.6" value="0" data-points="0"> Insuficient (Contrast evident insuficient, text ilizibil)</label>
                                    </div>
                                </div>
                                <div class="question" data-question-id="5.8">
                                    <p class="indicator-text"><span class="indicator-prefix">5.3.2.</span> Structura vizuală planificată (ex: heading-uri) susține accesibilitatea.</p>
                                    <div class="space-y-1 pl-4">
                                        <label><input type="radio" name="q5.8" value="3" data-points="3"> Exemplar (Structură H1-H6 corectă și logică în mockup)</label>
                                        <label><input type="radio" name="q5.8" value="2" data-points="2"> Competent (Structură în general corectă, mici erori)</label>
                                        <label><input type="radio" name="q5.8" value="1" data-points="1"> În Dezvoltare (Structura titlurilor inconsistentă/incorectă)</label>
                                        <label><input type="radio" name="q5.8" value="0" data-points="0"> Insuficient (Lipsa structurii cu heading-uri)</label>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <div class="mt-6 text-right font-semibold text-gray-700">Scor Secțiunea 5: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">21</span></div>
                    </div>
                    <div class="question-section border border-gray-300 p-6 rounded-lg shadow-md" data-section-id="6" data-section-name="Gestionarea Licențelor Media">
                        <h2 class="section-title">6. Gestionarea Licențelor Media (Planificată)</h2>
                        <div class="space-y-6">
                            <fieldset class="question-group">
                                <legend class="criteria-title">6.1. Gestionarea Licențelor Media (Planificată)</legend>
                                <div class="question" data-question-id="6.1">
                                    <p class="indicator-text"><span class="indicator-prefix">6.1.1.</span> Demonstrarea înțelegerii nevoii de a folosi media cu licențe corecte (ex: CC, Domeniu Public).</p>
                                    <div class="space-y-1 pl-4">
                                        <label><input type="radio" name="q6.1" value="2" data-points="2"> Exemplar/Competent (Înțelegere clară/Conștientizare a nevoii)</label>
                                        <label><input type="radio" name="q6.1" value="1" data-points="1"> În Dezvoltare (Menționare superficială)</label>
                                        <label><input type="radio" name="q6.1" value="0" data-points="0"> Insuficient (Se propune media protejată/Lipsă)</label>
                                    </div>
                                </div>
                                <div class="question" data-question-id="6.2">
                                    <p class="indicator-text"><span class="indicator-prefix">6.1.2.</span> Includerea unui plan (chiar sumar) pentru atribuirea surselor media.</p>
                                    <div class="space-y-1 pl-4">
                                        <label><input type="radio" name="q6.2" value="2" data-points="2"> Exemplar/Competent (Plan clar/sumar pentru atribuire)</label>
                                        <label><input type="radio" name="q6.2" value="1" data-points="1"> În Dezvoltare (Nicio mențiune despre cum/unde)</label>
                                        <label><input type="radio" name="q6.2" value="0" data-points="0"> Insuficient (Planul exclude atribuirea/Lipsă)</label>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                        <div class="mt-6 text-right font-semibold text-gray-700">Scor Secțiunea 6: <span class="section-score text-indigo-600">0</span> / <span class="section-max-score">4</span></div>
                    </div>
                </div>

                 <div id="action-buttons" class="mt-10 pt-6 border-t border-gray-300 flex flex-col sm:flex-row justify-center items-center gap-4">
                     <button type="button" id="resetBtn" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-offset-2 text-lg w-full sm:w-auto">
                        Resetare Formular
                    </button>
                     <button type="button" id="calculateScoreBtn" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-8 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 text-lg w-full sm:w-auto">
                        Calculează Scorul & Afișează Feedback
                    </button>
                     <button type="button" id="printPdfBtn" class="bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 text-lg w-full sm:w-auto">
                        Print / Salvează PDF
                    </button>
                </div>
            </form>

            <div id="results" class="mt-10 pt-8 border-t-2 border-gray-300 hidden">
                 <h2 class="text-2xl font-semibold text-gray-800 mb-6 text-center">Rezultate Evaluare</h2>
                 <div id="sectionScoresDisplay" class="mb-6 space-y-3">
                     </div>
                 <div class="text-center text-2xl font-bold text-gray-800 mb-6 bg-indigo-50 p-4 rounded-lg">
                     Scor Total General: <span id="totalScore" class="text-indigo-700">0</span> / <span id="maxTotalScore">100</span> </div>
                 <div id="feedbackMessage" class="text-left font-medium hidden">
                     </div>
            </div>

             </div> </div>

        <script>
        // --- Structura globală pentru datele procesate ---
        let processedEvaluationData = {};
        const questionnaireVars = {};
        let last_calculated_scores = null;

        // --- Funcții Utilitare ---
        function calculateSectionMaxScore(sectionElement) {
            let sectionMax = 0;
            if (!sectionElement) return 0;
            sectionElement.querySelectorAll('.question').forEach(question => {
                let maxPointsPerQuestion = 0;
                question.querySelectorAll('input[type="radio"][data-points]').forEach(input => {
                    const points = parseInt(input.dataset.points, 10);
                    if (!isNaN(points) && points > maxPointsPerQuestion) maxPointsPerQuestion = points;
                });
                sectionMax += maxPointsPerQuestion;
            });
            return sectionMax;
        }

        function updateDisplayedSectionMaxScore(sectionElement, maxScore) {
            if (!sectionElement) return;
            const maxScoreSpan = sectionElement.querySelector('.section-max-score');
            if (maxScoreSpan) maxScoreSpan.textContent = maxScore;
        }

        function calculateAndUpdateOverallMaxScore() {
            let overallMax = 0;
            document.querySelectorAll('.question-section').forEach(section => {
                const sectionMax = calculateSectionMaxScore(section);
                updateDisplayedSectionMaxScore(section, sectionMax);
                overallMax += sectionMax;
            });
            const maxTotalScoreSpan = document.getElementById('maxTotalScore');
            const finalMaxScore = 100; // Asigurăm că maximul este 100
            if (maxTotalScoreSpan) maxTotalScoreSpan.textContent = finalMaxScore;
            return finalMaxScore;
        }

        function populateDropdown(selectElement, optionsArray, defaultOptionText) {
            if (!selectElement) return;
            selectElement.innerHTML = `<option value="">${defaultOptionText}</option>`;
            if (selectElement.id === 'expertSelect' || selectElement.id === 'participantSelect') {
                optionsArray.sort((a, b) => {
                    const nameA = (typeof a === 'object' ? a.name : a) || '';
                    const nameB = (typeof b === 'object' ? b.name : b) || '';
                    return nameA.localeCompare(nameB);
                });
            }
             if (selectElement.id === 'groupSelect') {
                 optionsArray.sort((a, b) => {
                    const numA = parseInt(a.match(/\d+/)?.[0] || 0);
                    const numB = parseInt(b.match(/\d+/)?.[0] || 0);
                    return numA - numB;
                });
             }

            optionsArray.forEach(option => {
                const optionElement = document.createElement('option');
                if (typeof option === 'object' && option !== null && option.name) {
                     optionElement.value = option.name;
                     optionElement.textContent = option.name;
                     optionElement.dataset.email = option.email || 'N/A';
                     optionElement.dataset.name = option.name;
                } else {
                    optionElement.value = option;
                    optionElement.textContent = option;
                }
                selectElement.appendChild(optionElement);
            });
             selectElement.disabled = false;
        }

         function resetAndDisableDropdown(selectElement, defaultOptionText) {
             if (!selectElement) return;
             selectElement.innerHTML = `<option value="">${defaultOptionText}</option>`;
             selectElement.disabled = true;
             const expertSelect = document.getElementById('expertSelect');
             const groupSelect = document.getElementById('groupSelect');
             const participantSelect = document.getElementById('participantSelect');
             if (selectElement.id === 'monthSelect' && expertSelect) resetAndDisableDropdown(expertSelect, 'Selectați Expertul...');
             if (selectElement.id === 'expertSelect' && groupSelect) resetAndDisableDropdown(groupSelect, 'Selectați Grupa...');
             if (selectElement.id === 'groupSelect' && participantSelect) resetAndDisableDropdown(participantSelect, 'Selectați Cursantul...');
              if (selectElement.id === 'participantSelect') {
                 const emailDisplay = document.getElementById('participantEmailDisplay');
                 if (emailDisplay) emailDisplay.textContent = '...';
             }
         }

        // --- Funcție pentru încărcarea și procesarea datelor JSON ---
        async function loadAndProcessEvaluationData() {
            const jsonFilePath = 'Atasament 2_bis.json';
            const monthSelect = document.getElementById('monthSelect');
            const expertSelect = document.getElementById('expertSelect');
            const groupSelect = document.getElementById('groupSelect');
            const participantSelect = document.getElementById('participantSelect');
            const dataLoadingStatusDiv = document.getElementById('dataLoadingStatus');

            dataLoadingStatusDiv.textContent = 'Se încarcă datele participanților... Vă rugăm așteptați.';
            dataLoadingStatusDiv.classList.remove('hidden', 'error');
            monthSelect.disabled = true; expertSelect.disabled = true; groupSelect.disabled = true; participantSelect.disabled = true;

            try {
                await new Promise(resolve => setTimeout(resolve, 50));
                const response = await fetch(jsonFilePath);
                if (!response.ok) throw new Error(`HTTP ${response.status}: Nu s-a putut încărca ${jsonFilePath}.`);
                const rawData = await response.json();
                processedEvaluationData = {};
                if (!Array.isArray(rawData)) throw new Error("Format JSON invalid.");

                rawData.forEach(row => {
                    const luna = row["Lună evaluare media"]?.trim();
                    const expert = row["Expert Media"]?.trim();
                    let grupa = row["Grupa"]?.trim();
                    const nume = row["Nume"]?.trim();
                    const prenume = row["Prenume"]?.trim();
                    const email = row["E-mail"]?.trim();
                    if (luna && expert && grupa && nume && prenume) {
                        if (/^\d+$/.test(grupa)) grupa = `GRUPA ${grupa.padStart(3, '0')}`;
                        else if (!grupa.toUpperCase().startsWith("GRUPA ")) grupa = `GRUPA ${grupa}`;
                        const nume_complet = `${nume} ${prenume}`;
                        const participant_info = { "name": nume_complet, "email": email || 'N/A' };
                        if (!processedEvaluationData[luna]) processedEvaluationData[luna] = {};
                        if (!processedEvaluationData[luna][expert]) processedEvaluationData[luna][expert] = {};
                        if (!processedEvaluationData[luna][expert][grupa]) processedEvaluationData[luna][expert][grupa] = [];
                        if (!processedEvaluationData[luna][expert][grupa].some(p => p.name === nume_complet)) {
                            processedEvaluationData[luna][expert][grupa].push(participant_info);
                        }
                    }
                });
                console.log("Date procesate.");
                dataLoadingStatusDiv.classList.add('hidden');
                populateMonthDropdown();
            } catch (error) {
                console.error("Eroare JSON:", error);
                dataLoadingStatusDiv.textContent = `Eroare: ${error.message}. Verificați consola (F12).`;
                dataLoadingStatusDiv.classList.remove('hidden'); dataLoadingStatusDiv.classList.add('error');
                resetAndDisableDropdown(monthSelect, 'Eroare date'); resetAndDisableDropdown(expertSelect, '...'); resetAndDisableDropdown(groupSelect, '...'); resetAndDisableDropdown(participantSelect, '...');
            }
        }

        function populateMonthDropdown() {
            const months = Object.keys(processedEvaluationData).sort();
            const monthSelect = document.getElementById('monthSelect');
            if (!monthSelect) return;
            populateDropdown(monthSelect, months, 'Selectați Luna...');
            monthSelect.disabled = months.length === 0;
            if (months.length === 0 && !document.getElementById('dataLoadingStatus').classList.contains('hidden')) {}
            else if (months.length === 0) { monthSelect.innerHTML = `<option value="">Nu s-au găsit date</option>`; }
        }

        // --- Funcție pentru resetarea formularului ---
        function resetForm() {
            const form = document.getElementById('evaluationForm');
            form.reset();
            document.querySelectorAll('.section-score').forEach(span => span.textContent = '0');
            const resultsDiv = document.getElementById('results');
            resultsDiv.classList.add('hidden');
            last_calculated_scores = null;
            const monthSelect = document.getElementById('monthSelect');
            if (monthSelect) monthSelect.value = "";
            resetAndDisableDropdown(document.getElementById('expertSelect'), 'Selectați Expertul...');
            resetAndDisableDropdown(document.getElementById('groupSelect'), 'Selectați Grupa...');
            resetAndDisableDropdown(document.getElementById('participantSelect'), 'Selectați Cursantul...');
            alert("Formularul a fost resetat.");
        }

        // --- Inițializare și Event Listeners ---
        document.addEventListener('DOMContentLoaded', () => {
            const monthSelect = document.getElementById('monthSelect');
            const expertSelect = document.getElementById('expertSelect');
            const groupSelect = document.getElementById('groupSelect');
            const participantSelect = document.getElementById('participantSelect');
            const participantEmailDisplay = document.getElementById('participantEmailDisplay');
            const calculateScoreBtn = document.getElementById('calculateScoreBtn');
            const printPdfBtn = document.getElementById('printPdfBtn'); // Actualizat ID
            const resetBtn = document.getElementById('resetBtn');
            const resultsDiv = document.getElementById('results');
            const totalScoreSpan = document.getElementById('totalScore');
            const feedbackMessageDiv = document.getElementById('feedbackMessage');
            const sectionScoresDisplayDiv = document.getElementById('sectionScoresDisplay');
            const mainContentDiv = document.getElementById('main-content'); // Referință la div-ul principal

            loadAndProcessEvaluationData();

            monthSelect.addEventListener('change', () => {
                const selectedMonth = monthSelect.value;
                resetAndDisableDropdown(expertSelect, 'Selectați Expertul...');
                resetAndDisableDropdown(groupSelect, 'Selectați Grupa...');
                resetAndDisableDropdown(participantSelect, 'Selectați Cursantul...');
                if (selectedMonth && processedEvaluationData[selectedMonth]) {
                    const experts = Object.keys(processedEvaluationData[selectedMonth]).sort();
                    if (experts.length > 0) populateDropdown(expertSelect, experts, 'Selectați Expertul...');
                    else resetAndDisableDropdown(expertSelect, 'Niciun expert...');
                }
            });

            expertSelect.addEventListener('change', () => {
                const selectedMonth = monthSelect.value;
                const selectedExpert = expertSelect.value;
                resetAndDisableDropdown(groupSelect, 'Selectați Grupa...');
                resetAndDisableDropdown(participantSelect, 'Selectați Cursantul...');
                if (selectedMonth && selectedExpert && processedEvaluationData[selectedMonth]?.[selectedExpert]) {
                    const groups = Object.keys(processedEvaluationData[selectedMonth][selectedExpert]).sort((a, b) => {
                        const numA = parseInt(a.match(/\d+/)?.[0] || 0);
                        const numB = parseInt(b.match(/\d+/)?.[0] || 0);
                        return numA - numB;
                    });
                    if (groups.length > 0) populateDropdown(groupSelect, groups, 'Selectați Grupa...');
                    else resetAndDisableDropdown(groupSelect, 'Nicio grupă...');
                }
            });

             groupSelect.addEventListener('change', () => {
                const selectedMonth = monthSelect.value;
                const selectedExpert = expertSelect.value;
                const selectedGroup = groupSelect.value;
                resetAndDisableDropdown(participantSelect, 'Selectați Cursantul...');
                if (selectedMonth && selectedExpert && selectedGroup && processedEvaluationData[selectedMonth]?.[selectedExpert]?.[selectedGroup]) {
                    const participants = processedEvaluationData[selectedMonth][selectedExpert][selectedGroup].sort((a, b) => a.name.localeCompare(b.name));
                    if (participants.length > 0) populateDropdown(participantSelect, participants, 'Selectați Cursantul...');
                    else resetAndDisableDropdown(participantSelect, 'Niciun cursant...');
                }
            });

            participantSelect.addEventListener('change', () => {
                const selectedOption = participantSelect.options[participantSelect.selectedIndex];
                participantEmailDisplay.textContent = selectedOption.dataset.email || '...';
            });

            let overallMaxScore = calculateAndUpdateOverallMaxScore();

            if (calculateScoreBtn) {
                calculateScoreBtn.addEventListener('click', () => {
                    let overallScore = 0;
                    let sectionScoresData = {};
                    let allQuestionsAnswered = true;
                    sectionScoresDisplayDiv.innerHTML = '';
                    overallMaxScore = calculateAndUpdateOverallMaxScore();

                    if (Object.keys(questionnaireVars).length === 0) {
                         document.querySelectorAll('.question-section').forEach(section => {
                            const sectionId = section.dataset.sectionId;
                            questionnaireVars[sectionId] = { 'name': section.dataset.sectionName, 'questions': {} };
                            section.querySelectorAll('.question').forEach(question => {
                                const questionId = question.dataset.questionId;
                                const qVar = { value: -1 }; const pointsMap = {}; const optionsMap = {};
                                question.querySelectorAll('input[type="radio"]').forEach(rb => {
                                    const val = parseInt(rb.value, 10); const points = parseInt(rb.dataset.points, 10);
                                    if (!isNaN(val) && !isNaN(points)) { pointsMap[val] = points; optionsMap[rb.nextElementSibling.textContent.trim()] = val; }
                                });
                                questionnaireVars[sectionId]['questions'][questionId] = { var: qVar, points: pointsMap, options: optionsMap, label: question.querySelector('p.indicator-text') };
                            });
                        });
                    }

                    document.querySelectorAll('.question-section').forEach(section => {
                        const sectionId = section.dataset.sectionId;
                        const sectionName = section.dataset.sectionName || `Secțiunea ${sectionId}`;
                        const sectionMaxScore = calculateSectionMaxScore(section);
                        let currentSectionScore = 0;
                        section.querySelectorAll('.question').forEach(question => {
                            const questionId = question.dataset.questionId;
                            const selectedAnswer = question.querySelector('input[type="radio"]:checked');
                            let score = 0; let selectedValue = -1;
                            if (selectedAnswer && selectedAnswer.dataset.points) {
                               score = parseInt(selectedAnswer.dataset.points, 10); selectedValue = parseInt(selectedAnswer.value, 10);
                               if(isNaN(score)) score = 0; if(isNaN(selectedValue)) selectedValue = -1;
                            } else { allQuestionsAnswered = false; }
                            currentSectionScore += score;
                            if (questionnaireVars[sectionId]?.questions?.[questionId]) { questionnaireVars[sectionId].questions[questionId].var.value = selectedValue; }
                        });
                        const sectionScoreSpan = section.querySelector('.section-score');
                        if (sectionScoreSpan) sectionScoreSpan.textContent = currentSectionScore;
                        overallScore += currentSectionScore;
                        sectionScoresData[sectionId] = { name: sectionName, score: currentSectionScore, maxScore: sectionMaxScore };
                        const scoreLine = document.createElement('p');
                        scoreLine.classList.add('text-md', 'text-gray-700', 'flex', 'justify-between', 'items-center');
                        scoreLine.innerHTML = `<span class="font-medium">${sectionId}. ${sectionName}:</span><span class="font-semibold text-indigo-600 bg-indigo-50 px-2 py-1 rounded">${currentSectionScore} / ${sectionMaxScore}</span>`;
                        sectionScoresDisplayDiv.appendChild(scoreLine);
                    });

                    if (!allQuestionsAnswered) alert("Atenție! Nu ați răspuns la toate întrebările.");

                    totalScoreSpan.textContent = overallScore;
                    let feedbackText = ''; let feedbackClass = '';
                    const percentageScore = overallMaxScore > 0 ? (overallScore / overallMaxScore) * 100 : 0;
                    const resourcesLink = "ired.spiruharet.ro";
                    const resourcesLinkHtml = `<a href="http://${resourcesLink}" target="_blank" class="underline font-semibold hover:text-indigo-700">${resourcesLink}</a>`;

                    // Feedback detaliat
                    if (percentageScore < 30) {
                        feedbackText = `<strong>Nivel Insuficient (${percentageScore.toFixed(1)}%)</strong>: Competențele de design și multimedia necesită o dezvoltare fundamentală... Explorați resursele și tutorialele introductive disponibile pe ${resourcesLinkHtml} pentru a consolida aceste noțiuni esențiale.`;
                        feedbackClass = 'feedback-insufficient';
                    } else if (percentageScore < 60) {
                        feedbackText = `<strong>Nivel În Dezvoltare (${percentageScore.toFixed(1)}%)</strong>: Competențele sunt de bază, dar necesită îmbunătățiri semnificative... Consultați exemplele de bună practică, ghidurile de stil și tutorialele despre optimizarea media de pe ${resourcesLinkHtml}.`;
                        feedbackClass = 'feedback-developing';
                    } else if (percentageScore < 85) {
                        feedbackText = `<strong>Nivel Competent (${percentageScore.toFixed(1)}%)</strong>: Demonstrați o bună înțelegere și aplicare a majorității competențelor... Pentru a atinge excelența, concentrați-vă pe rafinarea detaliilor... Resurse avansate pot fi găsite pe ${resourcesLinkHtml}.`;
                        feedbackClass = 'feedback-competent';
                    } else {
                        feedbackText = `<strong>Nivel Exemplar (${percentageScore.toFixed(1)}%)</strong>: Demonstrați o înțelegere excelentă și aplicare consecventă și creativă a competențelor... Felicitări! Puteți explora tehnici avansate pe ${resourcesLinkHtml}.`;
                        feedbackClass = 'feedback-exemplary';
                    }


                    feedbackMessageDiv.innerHTML = feedbackText;
                    feedbackMessageDiv.className = 'text-left font-medium p-4 rounded-md';
                    feedbackMessageDiv.classList.add(feedbackClass, 'block');
                    feedbackMessageDiv.classList.remove('hidden');
                    resultsDiv.classList.remove('hidden');
                    last_calculated_scores = { total: overallScore, max_total: overallMaxScore, sections: sectionScoresData, feedback: feedbackText };

                    // Actualizează caseta de sumar
                    const printSummaryBox = document.getElementById('print-summary-box');
                    if (printSummaryBox) {
                        document.getElementById('printParticipantName').textContent = "Cursant: " + (participantSelect.value || 'N/A');
                        document.getElementById('printGroup').textContent = "Grupa: " + (groupSelect.value || 'N/A');
                        document.getElementById('printEvalDate').textContent = "Data evaluării: " + (new Date()).toLocaleDateString('ro-RO');
                        document.getElementById('printTotalScore').textContent = "Punctaj total: " + overallScore + " / " + overallMaxScore;
                    }

                    resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
                });
            }

             if (resetBtn) {
                 resetBtn.addEventListener('click', resetForm);
             }

             // --- Event Listener pentru Buton Print PDF ---
             if (printPdfBtn) {
                 printPdfBtn.addEventListener('click', () => {
                    if (!last_calculated_scores) {
                         alert("Vă rugăm calculați scorul înainte de a printa/salva ca PDF.");
                         return;
                     }
                     const selectedParticipantName = participantSelect.value;
                     if (!selectedParticipantName || selectedParticipantName === "Selectați Cursantul...") {
                         alert("Vă rugăm selectați un cursant înainte de a printa/salva ca PDF.");
                         return;
                     }
                     // Adăugăm informațiile selectate în caseta de sumar (care e vizibilă doar la print)
                     const printSummaryBox = document.getElementById('print-summary-box');
                     if (printSummaryBox) {
                         document.getElementById('printParticipantName').textContent = "Cursant: " + (participantSelect.value || 'N/A');
                         document.getElementById('printGroup').textContent = "Grupa: " + (groupSelect.value || 'N/A');
                         document.getElementById('printEvalDate').textContent = "Data evaluării: " + (new Date()).toLocaleDateString('ro-RO');
                         document.getElementById('printTotalScore').textContent = "Punctaj total: " + last_calculated_scores.total + " / " + last_calculated_scores.max_total;
                         // Nu mai este nevoie să manipulăm display-ul casetei aici, CSS se ocupă
                     } else {
                         console.error("Elementul #print-summary-box nu a fost găsit!");
                     }

                     window.print(); // Deschide dialogul de printare

                     // Nu mai este necesară ascunderea casetei după print, CSS o gestionează
                 });
             }

             calculateAndUpdateOverallMaxScore();

        }); // End DOMContentLoaded

    </script>

</body>
</html>
