<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluare Competente Design Multimedia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- aici păstrează restul stilurilor și head-ului original fără modificări -->
</head>
<body class="bg-gray-100 p-4 md:p-8">

    <!-- păstrează întregul conținut HTML original -->

    <script>
        // păstrează întregul script original fără modificări

        // Adaugă această funcție înainte de finalul scriptului existent
        function sendDataToGoogleSheets(data) {
            fetch('https://script.google.com/macros/s/AKfycbwvJnSiv8m5RAJUzCskHNItkvWSmJotv7OYgPG8vJPSFxQRNS3AiO4gqXm5sCZN0Kgr/exec', {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(() => {
                console.log('Date trimise cu succes în Google Sheets!');
            }).catch(error => {
                console.error('Eroare trimitere date:', error);
            });
        }

        // Actualizează evenimentul pentru butonul de print PDF
        if (printPdfBtn) {
            printPdfBtn.addEventListener('click', () => {
                if (!last_calculated_scores) {
                    alert("Vă rugăm calculați scorul înainte de a printa/salva ca PDF.");
                    return;
                }

                const participantName = participantSelect.value;
                const group = groupSelect.value;
                const month = monthSelect.value;
                const expert = expertSelect.value;

                if (!participantName || participantName === "Selectați Cursantul...") {
                    alert("Vă rugăm selectați un cursant înainte de a printa/salva ca PDF.");
                    return;
                }

                const dataToSend = {
                    participantName,
                    group,
                    month,
                    expert,
                    totalScore: last_calculated_scores.total,
                    maxScore: last_calculated_scores.max_total,
                    feedback: last_calculated_scores.feedback.replace(/<[^>]*>/g, '')
                };

                sendDataToGoogleSheets(dataToSend);

                const printSummaryBox = document.getElementById('print-summary-box');
                if (printSummaryBox) {
                    document.getElementById('printParticipantName').textContent = "Cursant: " + participantName;
                    document.getElementById('printGroup').textContent = "Grupa: " + group;
                    document.getElementById('printEvalDate').textContent = "Data evaluării: " + (new Date()).toLocaleDateString('ro-RO');
                    document.getElementById('printTotalScore').textContent = "Punctaj total: " + last_calculated_scores.total + " / " + last_calculated_scores.max_total;
                    printSummaryBox.classList.remove('hidden');
                }

                window.print();

                setTimeout(() => {
                    if (printSummaryBox) {
                        printSummaryBox.classList.add('hidden');
                    }
                }, 500);
            });
        }

    </script>

</body>
</html>
